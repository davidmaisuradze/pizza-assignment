{"version":3,"sources":["../../src/utils/log-error.utils.js"],"names":["err","req","res","next","APIError","HttpStatus","INTERNAL_SERVER_ERROR","error","message","errors","Array","isArray","RequiredError","makePretty","Object","keys","forEach","key","status","json"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;kBAEe,UAACA,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB,EAAyB;AACpC,QAAI,CAACH,GAAL,EAAU;AACN,eAAO,IAAII,oBAAJ,CAAa,cAAb,EAA6BC,qBAAWC,qBAAxC,CAAP;AACH;;AAED,QAAMC,QAAQ;AACVC,iBAASR,IAAIQ,OAAJ,IAAe;AADd,KAAd;;AAIA,QAAIR,IAAIS,MAAR,EAAgB;AACZF,cAAME,MAAN,GAAe,EAAf;AADY,YAELA,MAFK,GAEKT,GAFL,CAELS,MAFK;;AAGZ,YAAIC,MAAMC,OAAN,CAAcF,MAAd,CAAJ,EAA2B;AACvBF,kBAAME,MAAN,GAAeG,0BAAcC,UAAd,CAAyBJ,MAAzB,CAAf;AACH,SAFD,MAEO;AACHK,mBAAOC,IAAP,CAAYN,MAAZ,EAAoBO,OAApB,CAA4B,eAAO;AAC/BT,sBAAME,MAAN,CAAaQ,GAAb,IAAoBR,OAAOQ,GAAP,EAAYT,OAAhC;AACH,aAFD;AAGH;AACJ;;AAEDN,QAAIgB,MAAJ,CAAWlB,IAAIkB,MAAJ,IAAcb,qBAAWC,qBAApC,EAA2Da,IAA3D,CAAgEZ,KAAhE;;AAEA,WAAOJ,MAAP;AACH,C","file":"log-error.utils.js","sourcesContent":["import HttpStatus from 'http-status';\r\nimport APIError, { RequiredError } from './error-utils';\r\n\r\nexport default (err, req, res, next) => {\r\n    if (!err) {\r\n        return new APIError('Server error', HttpStatus.INTERNAL_SERVER_ERROR);\r\n    }\r\n\r\n    const error = {\r\n        message: err.message || 'Internal Server Error.'\r\n    };\r\n\r\n    if (err.errors) {\r\n        error.errors = {};\r\n        const {errors} = err;\r\n        if (Array.isArray(errors)) {\r\n            error.errors = RequiredError.makePretty(errors);\r\n        } else {\r\n            Object.keys(errors).forEach(key => {\r\n                error.errors[key] = errors[key].message;\r\n            });\r\n        }\r\n    }\r\n\r\n    res.status(err.status || HttpStatus.INTERNAL_SERVER_ERROR).json(error);\r\n\r\n    return next();\r\n}\r\n"]}
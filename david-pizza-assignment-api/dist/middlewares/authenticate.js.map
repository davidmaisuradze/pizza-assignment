{"version":3,"sources":["../../src/middlewares/authenticate.js"],"names":["req","res","next","token","headers","authorization","decoded","jwt","verify","process","env","JWT_SECRET","UserModel","findOne","email","currentUser","status","HttpStatus","UNAUTHORIZED","json"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;;wFAEe,iBAAOA,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEDC,6BAFC,GAEOH,IAAII,OAAJ,CAAYC,aAFnB;;AAAA,4BAGF,CAACF,KAHC;AAAA;AAAA;AAAA;;AAIGG,+BAJH,GAIaC,uBAAIC,MAAJ,CAAWL,KAAX,EAAkBM,QAAQC,GAAR,CAAYC,UAA9B,CAJb;AAAA;AAAA,+BAKqBC,eAAUC,OAAV,CAAkB,EAACC,OAAOR,QAAQQ,KAAhB,EAAlB,CALrB;;AAAA;AAKHd,4BAAIe,WALD;;AAMHb;AANG;AAAA;;AAAA;AAAA,yDAQID,IAAIe,MAAJ,CAAWC,qBAAWC,YAAtB,EAAoCC,IAApC,CAAyC,cAAzC,CARJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,yDAWAlB,IAAIe,MAAJ,CAAWC,qBAAWC,YAAtB,EAAoCC,IAApC,CAAyC,cAAzC,CAXA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K","file":"authenticate.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport UserModel from '../models/user.model';\r\nimport HttpStatus from 'http-status';\r\n\r\nexport default async (req, res, next) => {\r\n    try {\r\n        const token = req.headers.authorization;\r\n        if (!!token) {\r\n            const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n            req.currentUser = await UserModel.findOne({email: decoded.email});\r\n            next();\r\n        } else {\r\n            return res.status(HttpStatus.UNAUTHORIZED).json('unauthorized');\r\n        }\r\n    } catch (err) {\r\n        return res.status(HttpStatus.UNAUTHORIZED).json('unauthorized');\r\n    }\r\n}\r\n"]}